# 베이즈 통계학 기초
> ### 🤔 베이지안 사고
> 베이지안은  통계 방법 중 하나로, 데이터가 있는 상황에서 데이터가 추가되는 경우에 확률을 업데이트하는 것을 말합니다.
> 우리가 흔히 알 수 있는 문제로 **[몬티홀 문제](https://youtu.be/Rvz4Cq55990)** 가 있습니다. 즉, 사전 확률을 이미 안다고 했을 때, 사전 확률을 통해 사후 확률로 업그레이트하는 것입니다.

## 조건부 확률 (The Law of Conditional Probability)

$$ P(A | B) = \frac{P(A \cap B)}{P(B)} $$
- 조건부 확률 $P(A|B)$ 는 사건 $ B $가 일어났을 때 사건 $ A $가 발생할 확률을 말합니다.

$$
 P(A | B)P(B) = \frac{P(A \cap B)}{P(B)}P(B) \\
 P(A | B)P(B) = P(A \cap B)P(B)
$$
- 양변에 $P(B)$를 곱하게 되면, 아래와 같은 식을 구할 수 있습니다.

$$ P(A \cap B)  = P(B)P(A|B)$$

- $ B $ 라는 정보가 주어진 상황에서 $A$의 확률은 B와 교집합들의 합으로 구성되어 있습니다. (= 표본의 공간이 줄어듬)

> 🔍 총 확률의 법칙 : A의 모든 확률은 주어진 B에 대해 각각 일어날 확률의 총합으로 표현할 수 있습니다. [🔗 전체 확률 법칙과 베이즈 정리 - 방구석 연구실](https://idiqpnm.tistory.com/5)

## 베이즈 정리 (Bayes Theorem)
> 베이즈 정리는 조건부 확률을 이용하여 **정보를 갱신하는 방법**입니다.

$$ P(\theta/D) = P(\theta)\frac{P(\theta|D)}{P(D)} \\
\\
P(\text{사후확률}) = P(\text{사전확률})\frac{P(\text{가능도})}{P(\text{증거})} $$

- **사후확률(Prior)** : 업데이트한 사건이 일어날 확률 _e.g. 검진되었을 떄 실제 COVID 감염률_
- **가능도,우도(Likelihood)**: 데이터가 관찰된 확률 _e.g. 검진률, 오검진률_
- **사전확률(Prior)**: COVID 발병 사건(사건이 일어날 확률) _e.g. COVID의 발병률_
- **증거(Evidence)**: 검진 결과(데이터)  _e.g. 실제로 COVID 확진 데이터_

> $\theta$는 COVID 발병 사건으로 관찰이 불가능한 정의이고 $D$는 테스트 결과로 관찰이 가능한 정의입니다.

### COVID 예제 문제
> 🤔 사전확률, 민감도(Recall), 오탐률(False Alarm)을 가지고 정밀도(Precison)을 계산하는 문제를 풀어봅시다.

COVID-00의 발병률이 10%라고 한다. COVID-00에 실제로 걸렸을 때 검진될 확률은 99%이고 실제로 걸리지는 않았지만 오검진 확률은 1%이다. 그렇다면, 어떤 사람이 질병에 걸렸다고 검진이 나왔을 때, 정말로 확진이 될 확률은?

- 사전확률 : 발병률 10%
- 가능도 1 : 실제로 걸렸을 때 검진될 확률 99%
- 가능도 2 : 실제로 걸리지 않았을 때 오검진 확률 1%

$$ P(D) = \sum_\theta P(\theta){P(D|\theta)} \\
 0.99(\text{가능도 1}) \times 0.1(\text{발병률}) + 0.01(\text{가능도 2}) \times 0.9(\text{발병률}) = 0.108 $$

- 위 사후 확률을 구하는 식을 대입해 보면,
$$
 0.1(\text{가능도 1}) \times \frac{0.99(\text{가능도 1})}{0.108(\text{증거})} = 0.916(\text{사후 확률, 정밀도}) $$

 > 만약 가능도 2(오탐률)이 증가한다면, 정밀도(Precision) 값을 줄어들게 됩니다.

 - 시각화

> 📌 베이즈 정리를 통해 새로운 데이터가 들어왔을 때 **앞서 계산한 사후 확률을 사전 확률로 사용**하여 갱신할 수 있습니다. _e.g 앞서 판정 받은 사람이 두번째 검진 때도 양성이 나왔을 때 걸렸을 확률은?

## 인과관계(Causality)
> - 조건부  확률은 유용한 통계적 해석을 제공하지만 인과 관계를 추론하는 것은 데이터가 많아져도 불가능합니다.
> - 인과관계는 **데이터 분포의 변화에 강건한 예측 모형**을 만들 때 필요합니다.

- 하지만 인과관계 만으로 높은 예측 정확도를 담보하기 어렵습니다.

- 인과관계를 알아내기 위해서는 **중첩 요인(Cofounding Factor)효과를 제거**하고 원인에 해당되는 변수만 계산해야합니다.
- 만약 제거하지 않는다면 **가짜 연관성(Spurious correlation)** 이 나오기 때문입니다.


