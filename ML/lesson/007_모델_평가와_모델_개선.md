# λ¨λΈ ν‰κ°€
> κ³Όλ€μ ν•©μ΄λ‚ κ³Όμ†μ ν•©μ΄ λ°μƒν–μ„ κ²½μ°, μ°λ¦¬λ” λ¨λΈμ„ κ°μ„ μ‹ν‚¤λ” λ°©λ²•μ„ μ°Ύμ•„μ•Όν•λ‹¤. μ°μ„ , μ–΄λ–¤ λ¨λΈμ΄ μΆ‹μ€ λ¨λΈμΈμ§€ ν™•μΈν•κΈ° μ„ν—¤ `νΈν–¥-λ¶„μ‚° νΈλ μ΄λ“ μ¤ν”„`λ¥Ό ν†µν•΄ κ· ν•μ„ λ‹¤λ£¬λ‹¤.

## κ³Όλ€μ ν•©κ³Ό κ³Όμ†μ ν•©
### κ³Όμ†μ ν•©(Underfitting)
> λ¨λΈμ΄ **μ¶©λ¶„ν λ³µμ΅ν•μ§€ μ•μ•„** ν•™μµ λ°μ΄ν„°μ κµ¬μ΅°λ‚ ν¨ν„΄μ„ μ •ν™•ν λ°μν•μ§€ λ»ν•λ” λ¬Έμ μ…λ‹λ‹¤.

- κ·Έλ§νΌ λ„λ¬΄ λ‹¨μν•΄μ„ μΌλ°ν™” μ„±μ§λ„ ν•™μµν•μ§€ λ»ν• μƒνƒλ¥Ό λ§ν•©λ‹λ‹¤.
- ν›λ ¨ λ°μ΄ν„°μ™€ ν…μ¤νΈλ°μ΄ν„°μ μ¤μ°¨κ°€ λ„λ¬΄ ν¬κ² λ‚λ” ν„μƒμ…λ‹λ‹¤.
- λ¨λΈμ μ μ•½μ„ μ¤„μ΄κ±°λ‚ νλΌλ―Έν„°κ°€ λ” λ³µμ΅ν• λ¨λΈμ„ μ„ νƒν•μ—¬ μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•©λ‹λ‹¤.

### κ³Όλ€μ ν•©(Overfitting)
> λ¨λΈμ΄ **ν•™μµ λ°μ΄ν„°μ—λ§ μ§€λ‚μΉκ² μµμ ν™”**ν•μ—¬ μƒλ΅μ΄ λ°μ΄ν„°μ—λ” λ¶„λ¥λ‚ μμΈ΅μ„ μν–‰ν•μ§€ λ»ν•λ” λ¬Έμ μ…λ‹λ‹¤.

-  ν›λ ¨ λ°μ΄ν„°μ—λ§ λ§μ¶° μκΈ° λ•λ¬Έμ— μΌλ°ν™”κ°€ μ•λλ” μƒνƒλ¥Ό λ§ν•©λ‹λ‹¤.
- ν…μ¤νΈλ°μ΄ν„°μ—λ§ μ¤μ°¨(loss)κ°€ μ»¤μ§€λ” ν„μƒμ…λ‹λ‹¤.
- ν›λ ¨ λ°μ΄ν„°λ¥Ό λ” λ§μ΄ λ¨μΌκ±°λ‚ μ •κ·ν™”, μ •μΉ™ν™”, dropoutλ“±μ„ ν†µν•΄ μ λ‹Ήν λ³µμ΅ν• λ¨λΈμ„ μλ™μ„ μ°Ύμ•„ μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•©λ‹λ‹¤.

### μΌλ°ν™”(Generalization)
>**ν›λ ¨ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„°κ°€ λΉ„μ·ν•κ² μΆ‹μ€ μ„±λ¥**μ„ λ‚΄λ” κ²½μ°λ¥Ό λ§ν•©λ‹λ‹¤.

><details><summary> <strong>π” μ •κ·ν™”, μ •μΉ™ν™”, μΌλ°ν™” μ λ€λ΅ μ΄ν•΄ν•κΈ°</strong> </summary>
> <strong>μ •κ·ν™”(Normalization)</strong>λ” λ°μ΄ν„° λ‹¨μ„λ¥Ό λ§μ¶”κΈ° μ„ν•΄ 0κ³Ό 1μ‚¬μ΄ κΈ°μ¤€μΌλ΅ λ§μ¶° μ£Όλ” κ²ƒμ„ μλ―Έν•κ³  <strong>μ •μΉ™ν™”(Regulalization;κ·μ )</strong>λ” κ³Όμ ν•©μ„ λ§‰κΈ°μ„ν•΄ μΌλ°ν™” μ‹ν‚¤λ” λ°©λ²•μ„ μλ―Έν•©λ‹λ‹¤. κ·Έλ¦¬κ³  <strong>μµμ ν™”(Optimization)</strong>λ” ν›λ ¨λ°μ΄ν„°λ΅μ„ λ” μΆ‹μ€ μ„±λ¥μ„ λ‚΄κΈ° μ„ν•΄ λ¨λΈμ„ μ΅°μ •ν•λ” κ²ƒμ…λ‹λ‹¤. μ¦‰, μΌλ°ν™” μ§€μ κΉμ§€ μ¤κΈ° μ„ν•΄ μ μ ν• νλΌλ―Έν„°λ¥Ό μ°Ύλ” κ³Όμ •μ„ μµμ ν™”λΌκ³  ν•©λ‹λ‹¤.
</details>

## λ¶„μ‚° νΈν–¥ νΈλ μ΄λ“μ¤ν”„(Bias & Variance Trade off)
> λ¨λΈμ΄ κ³Όμ†μ ν•©μ΄λ‚ κ³Όλ€μ ν•©μ΄ λμ—λ”μ§€ μ•κΈ° μ„ν•΄(νƒμ§€) λ¶„μ‚° νΈν–¥ νΈλ μ΄λ“ μ¤ν”„λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.


### νΈν–¥(Bias)
> νΈν–¥μ€ ν•™μµ μ•κ³ λ¦¬μ¦μ—μ„ **μλ»λ κ°€μ •μΌλ΅ μΈν• μ¤λ¥**λ΅ νΈν–¥μ΄ λ†’μΌλ©΄ νΉμ„±κ³Ό νƒ€κΉƒμ κ΄€κ³„λ¥Ό μ νμ•…ν•μ§€ λ»ν•©λ‹λ‹¤.
- λ°μ΄ν„°κ°€ νƒ€κΉƒμΌλ΅λ¶€ν„° λ–¨μ–΄μ Έ μλ” μ •λ„
- ν›λ ¨ λ°μ΄ν„°μ—μ„ μ¤λ¥ κ°’μ΄ ν¬κ² λ‚λ” κ²½μ° κ³Όμ† μ ν•©μ΄ λ°μƒν•©λ‹λ‹¤.

### λ¶„μ‚°(Variance)
> **ν›λ ¨ λ°μ΄ν„°μ…‹μ λ³€ν™”μ— λ―Όκ°μ„±μΌλ΅ λ°μƒν•λ” μ¤μ°¨**λ΅ λ¶„μ‚°μ΄ λ†’μΌλ©΄ ν•™μµ λ°μ΄ν„°μ λ…Έμ΄μ¦κ°€ λ―Όκ°ν•κ² μ ν•©ν•μ—¬ ν…μ¤νΈ λ°μ΄ν„°μ—μ„ μΌλ°ν™”λ¥Ό μλ»ν•κ² λλ‹¤.
- λ°μ΄ν„° μ…‹ λ‚΄ λ°μ΄ν„°κ°€ μ–Όλ§λ‚ νΌμ Έ μλ”μ§€λ¥Ό λ‚νƒ€λ‚΄λ” μ²™λ„
- ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ μ¤μ°¨κ°€ ν¬κ² λ‚λ” κ²½μ° κ³Όλ€ μ ν•©μ΄ λ°μƒν•©λ‹λ‹¤.


> μ¦‰, μ—λ¬μ¨μ„ κ°€μ¥ λ‚®μ¶ μ μλ” μ§€μ κΉμ§€λ§ ν•™μµ μ‹μΌλ©΄ λλ” κ²ƒμ…λ‹λ‹¤. μ™„λ²½ν•κ² μ κ±°ν•  μ μ—†μΌλ‹ κ°€μ¥ μ μ ν• μ§€μ μ„ μ°ΎμΌλ©΄ λλ”κ±°μ£ .

[π”— The Dangers of Under-fitting and Over-fitting - lsabella Lindgren](https://medium.com/analytics-vidhya/the-dangers-of-under-fitting-and-over-fitting-495f9efa1847)

# λ¨λΈ κ°μ„ 
## ν•μ΄νΌ νλΌλ―Έν„° νλ‹(Hyperparameter Tuning)
> κ³Όλ€μ ν•©λ λ¨λΈμ„ μΌλ°ν™”λ μ§€μ κΉμ§€ μ¤κ²ν•κΈ° μ„ν•΄ μµμ μ ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό μ°Ύλ” μµμ ν™”(optimization) κ³Όμ •μ΄ ν•„μ”ν•©λ‹λ‹¤.(μΌλ… ~~λ…Έκ°€λ‹¤ μ‘μ—…~~μ…λ‹λ‹¤.)

### κ²©μ κ²€μƒ‰(GridSearch)
- κ²€μ¦ν•κ³  μ‹¶μ€ **ν•μ΄νΌ νλΌλ―Έν„°λ“¤μ μμΉλ¥Ό μ •ν•΄μ£Όκ³ ** λ¨λ‘ κ²€μ •ν•©λ‹λ‹¤.
- λ¨λ“  λ§¤κ°λ³€μ κ°’λ“¤μ μ΅°ν•©μΌλ΅ ν‰κ°€ν•μ—¬ μµμ μ μ„ νƒμ„ κ²°μ •ν•©λ‹λ‹¤.
- ν•μ§€λ§, κ·Έλ§νΌ λ§μ€ μ΅°ν•©μ΄ μμΌλ©΄ λ§μ€ μ‹κ°„μ„ μ†λΉ„ν•λ‹¤λ” λ¬Έμ μ μ΄ μμµλ‹λ‹¤.

```py
from sklearn.model_selection import  GridSearchCV

param_grid = {
    'max_depth' : [None, 1, 2, 3, 4],
    'max_leaf_nodes' : [3, 5, 7, 9]
}

grid_search = GridSearchCV(Model, param_grid=param_grid, scoring='accuary', cv=5, n_jobs=1)
grid_search.fit(X_train, y_train)

df = pd.DataFrame(grid_search.cv_results_)
```
- `estimator` : λ¨λΈ κ°μ²΄ μƒμ„±
- `param_grid` : ν•μ΄νΌ νλΌλ―Έν„° λ©λ΅μ„ `Dictionary` ν•νƒλ΅ μ „λ‹¬ (νλΌλ―Έν„° κ°’μ€ `List`)
-  `scoring` : ν‰κ°€ μ§€ν‘λ¥Ό λ‚νƒ€λ‚΄λ©°, μ—¬λ¬ κ°μΌ κ²½μ°, `list`λ΅ λ¬¶μ–΄ μ§€μ •ν•λ‹¤.
-  `refit` : μµμ μ νλΌλ―Έν„°λ¥Ό μ •ν•  λ• μ‚¬μ©ν•λ” ν‰κ°€μ§€ν‘λ΅ μ—¬λ¬ κ°μ ν‰κ°€μ§€ν‘λ¥Ό μ„¤μ •ν• κ²½μ° λ°λ“μ‹ μ„¤μ •ν•λ‹¤.
-  `cv` : κµμ°¨ κ²€μ¦ μ‹, fold κ°―μ
-  `n_jobs` L μ‚¬μ©ν•  CPU μ½”μ–΄ κ°―μ (None:1(default), -1: λ¨λ“  μ½”μ–΄)

> `Sklearn`μ `GridSearchCV` ν•¨μλ” μ „μ²λ¦¬ κ³Όμ •μ—μ„ ν¨κ³Όμ μΌλ΅ λ°μν•κΈ° μ–΄λ µκΈ° λ–„λ¬Έμ— `sklearn.model_selection.ParameterGrid`λΌλ” ν•¨μλ¥Ό μ‚¬μ©ν•κΈ°λ„ ν•©λ‹λ‹¤.  [π”— λ¨λΈ μ„±λ¥ ν–¥μƒμ„ μ„ν• ν•μ΄νΌ νλΌλ―Έν„° νλ‹ - GIL'S LAB](https://gils-lab.tistory.com/10)

[π”— GridSearch κ³µμ‹λ¬Έμ„](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV)
### λλ¤ κ²€μƒ‰(RandonizedSearch)
- κ²€μ¦ν•κ³  μ‹¶μ€ **ν•μ΄νΌ νλΌλ―Έν„°λ“¤μ λ²”μ„λ¥Ό μ§€μ •**ν•κ³  **λ¬΄μ‘μ„λ΅ μ§€μ •**ν•΄ κ²€μ •ν•λ‹¤.

```py
from sklearn.model_selection import RandomizedSearchCV

param_drstributuions = {
    'max_depth' : range(1, 11),
    'max_leaf_nodes' : range(3, 31, 3)
}

grid_search = GridSearchCV(Model, param_drstributuions=param_drstributuions, n_iter=60, cv=5, n_jobs=1)
grid_search.fit(X_train, y_train)
```
- `estimator` : λ¨λΈ κ°μ²΄ μƒμ„±
- `param_grid` : ν•μ΄νΌ νλΌλ―Έν„° λ©λ΅μ„ `Dictionary` ν•νƒλ΅ μ „λ‹¬ (νλΌλ―Έν„° κ°’μ€ `List`)
-  `scoring` : ν‰κ°€ μ§€ν‘λ¥Ό λ‚νƒ€λ‚΄λ©°, μ—¬λ¬ κ°μΌ κ²½μ°, `list`λ΅ λ¬¶μ–΄ μ§€μ •ν•λ‹¤.
-  `n_iter` : νλΌλ―Έν„° κ²€μƒ‰ νμ (μ •ν•΄μ§„ λ¶„ν¬ λ‚΄μ—μ„ λ¬΄μ‘μ„λ΅ μƒν”λ§)
-  `refit` : μµμ μ νλΌλ―Έν„°λ¥Ό μ •ν•  λ• μ‚¬μ©ν•λ” ν‰κ°€μ§€ν‘λ΅ μ—¬λ¬ κ°μ ν‰κ°€μ§€ν‘λ¥Ό μ„¤μ •ν• κ²½μ° λ°λ“μ‹ μ„¤μ •ν•λ‹¤.
-  `cv` : κµμ°¨ κ²€μ¦ μ‹, fold κ°―μ
-  `n_jobs` L μ‚¬μ©ν•  CPU μ½”μ–΄ κ°―μ (None:1(default), -1: λ¨λ“  μ½”μ–΄)

### ν›λ ¨ κ²°κ³Ό λ„μ¶
- `predict_proba(x)` : λ¶„λ¥λ¬Έμ μ—μ„ classλ³„ ν™•λ¥ μ„ λ°ν™ν•λ‹¤.
- `cv_results_` : νλΌλ―Έν„° μ΅°ν•© λ³„ ν‰κ°€ κ²°κ³Όλ¥Ό λ”•μ…”λ„λ¦¬λ΅ λ°ν™ν•λ‹¤.
- `best_params_` : κ°€μ¥ μΆ‹μ€ μ„±λ¥μ„ λ‚Έ νλΌλ―Έν„° μ΅°ν•©μ„ λ°ν™ν•λ‹¤.
- `best_estimators_`: κ°€μ¥ μΆ‹μ€ μ„±λ¥μ„ λ‚Έ λ¨λΈ λ°ν™ν•λ‹¤.
- `best_score_`: κ°€μ¥ μΆ‹μ€ μ μλ¥Ό λ°ν™ν•λ‹¤.
- `rank_test_score` : ν…μ¤νΈ μμ„
- `mean_score_time` : μμΈ΅μ— κ±Έλ¦¬λ” μ‹κ°„
- `split{n}_test_score` : κµμ°¨ κ²€μ¦ κ²°κ³Ό

[π”— [DL] Hyperparameter Search - Daikoku](https://m.blog.naver.com/jjys9047/222066330831)
[π”— RandomizedSearch κ³µμ‹λ¬Έμ„](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html)<br> [π’» μ‹¤μµ νμΌ λ°”λ΅κ°€κΈ°](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV)
