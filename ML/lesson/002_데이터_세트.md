# λ°μ΄ν„° μ •λ¦¬
## μ •ν•λ°μ΄ν„°μ™€ λΉ„μ •ν• λ°μ΄ν„°
- **μ •ν• λ°μ΄ν„°(Structured Data)** : λ―Έλ¦¬ μ •ν•΄λ†“μ€ ν•μ‹κ³Ό κµ¬μ΅°κ°€ μλ” κµ¬μ΅°ν™”λ λ°μ΄ν„°
- **λΉ„μ •ν• λ°μ΄ν„°(Semi-Structured Data)**: μ‚¬μ§„μ΄λ‚ λ¬Έμ, μμ„±κ³Ό κ°™μ΄ μ»΄ν“¨ν„°κ°€ μ΄ν•΄ν•  μ μ—†λ” κµ¬μ΅°μ λ°μ΄ν„°
- **λ°μ •ν• λ°μ΄ν„°(Unstructured Data)**: λ°μ΄ν„°μ κµ¬μ΅° μ •λ³΄λ¥Ό λ°μ΄ν„°μ™€ ν•¨κ» μ κ³µν•λ” νμΌ _eg. XML, HTML, JSON_

## λ°μ΄ν„° μ„ΈνΈ
### λ°μ΄ν„°λ¥Ό μ„ λ³„ν•λ” κ·μΉ™
1. μ „ν€ μƒκ΄€μ—†λ” λ°μ΄ν„°λ” λ²„λ ¤λΌ. _ex) μ„μΈ λ‚ μ”¨λ¥Ό μ•κΈ°μ„ν•΄ λ¶€μ‚° λ‚ μ”¨ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ” κ²½μ°_
2. λΌλ²¨λ§μ΄ μλ»λ λ°μ΄ν„°λ” κ°€μ Έμ¤μ§€ λ§λΌ. _ex) Out-lier_

### λ°μ΄ν„° μ„ΈνΈ

<img src="https://user-images.githubusercontent.com/55238671/209548942-07d9e3f5-132c-4834-9acf-2bcc3e3492a7.png">


> <details> <summary> π” μ „μ²΄ λ°μ΄ν„°μ„ΈνΈλ΅ ν‰κ°€λ¥Ό μ§„ν–‰ν•κ² λλ©΄? </summary>
> μ„±λ¥μ΄ μ λ‚μ¬ μ λ°–μ— μ—†μµλ‹λ‹¤. ν›λ ¨ λ°μ΄ν„°μ™€ κ²€μ¦ λ°μ΄ν„°λ¥Ό λ¶„λ¦¬ν•μ§€ μ•κ³  ν•™μµμ„ ν•κ²λλ©΄ Data Leakage κ°€ λ°μƒν•μ—¬ κ³Όμ ν•©μΌλ΅ μ„±λ¥μ„ λ–¨μ–΄νΈλ¦¬κ² λ©λ‹λ‹¤.
> </detail>

- **ν•™μµ λ°μ΄ν„° (Training Data)**
λ¨λΈμ΄ ν•™μµν•  λ• μ‚¬μ©ν•λ” λ°μ΄ν„°λ΅ λ¨λΈμ μ„±λ¥μ„ μΆμ°ν•λ‹¤.

- **κ²€μ¦ λ°μ΄ν„° (Validation Data)**
  - **λ¨λΈμ μ„±λ¥μ„ ν‰κ°€ν•κΈ° μ„ν•΄** μ‚¬μ©ν•λ” λ°μ΄ν„°λ΅, μ„±λ¥μ„ λ†’μΌ λ• κΉμ§€ λ°λ³µν•λ‹¤.
  - μλΉ„ ν…μ¤νΈ λ°μ΄ν„°λΌκ³  μƒκ°ν•λ©΄ λλ‹¤.
  - κµμ°¨ κ²€μ¦ν• λ•μ—λ„ μ“°μΈλ‹¤.

- **ν…μ¤νΈ λ°μ΄ν„°(Test Data)**
μ• κ²°κ³Ό(ν•™μµ, κ²€μ¦)μ— λ§μ΅±μ¤λ¬μ› λ‹¤λ©΄ μµμΆ…μ μΌλ΅ ν…μ¤νΈλ¥Ό μ„ν•΄ μ‚¬μ©ν•λ” λ°μ΄ν„°μ΄λ‹¤.

> **π“ λ°μ΄ν„° μ„ΈνΈ κ·μΉ™**
> - ν›λ ¨ λ°μ΄ν„° μ„ΈνΈλ” ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ³΄λ‹¤ λ§μ•„μ•Ό ν•λ‹¤.
> - λ‘ μ„ΈνΈκ°„μ— μ¤‘λ³µ λ°μ΄ν„°κ°€ μµλ€ν• μ—†μ–΄μ•Ό ν•λ‹¤.
> - λ‘ μ„ΈνΈμ νƒ€κΉƒ ν΄λμ¤ λΉ„μ¨ λ¶„ν¬κ°€ λ™μΌν•΄μ•Ό ν•λ‹¤.

## ν›λ ¨κ³΅μ„ κ³Ό κ²€μ¦ κ³΅μ„ (Validation Curve)
> ν•μ΄νΌ νλΌλ―Έν„°μ— λ€ν• ν›λ ¨, κ²€μ¦ μ¤μ½”μ–΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

<img width="682" alt="image" src="https://user-images.githubusercontent.com/55238671/210363176-980fe0dc-5cb4-46db-b8dc-ca75880213c2.png">


### ν•™μµκ³΅μ„ 
> ν•™μµ λ°μ΄ν„°μ μ–‘μ„ λλ¦¬λ©΄μ„ λ¨λΈμ μ„±λ¥μ„ ν‰κ°€ν•λ” κ·Έλν”„
> - X(ν›λ ¨ λ°μ΄ν„°μ),Y(μ •ν™•λ„)

```py
from matplotlib import pyplot as plt
from sklearn.model_selection import learning_curve

# ν•™μµ κ³΅μ„  λ§λ“¤κΈ°
train_sizes, train_scores, test_scores = learning_curve(estimator=λ¨λΈ, X=X_train, y=y_train, train_sizes=np.linspace(0.1, 1.0, 10), cv=λ°λ³µμ)

# ν•™μµ κ³΅μ„  κ·Έλ¦¬κΈ°
## ν•™μµ μ •ν™•λ„
plt.plot(train_sizes, train_mean, color='blue', marker='o', markersize=5, label='training accuracy')
plt.fill_between(train_sizes, train_mean + train_std, train_mean - train_std, alpha=0.15, color='blue')
## κ²€μ¦ μ •ν™•λ„
plt.plot(train_sizes, test_mean, color='green', linestyle='--', marker='s', markersize=5, label='validation accuracy')
plt.fill_between(train_sizes, test_mean + test_std, test_mean - test_std, alpha=0.15, color='green')

## κ·Έλ¦¬λ“ μ™Έ λΌλ²¨
plt.grid()
plt.xlabel('Number of training samples')
plt.ylabel('Accuracy')
plt.legend(loc='lower right')
plt.tight_layout()
plt.show()
```
- `train_sizes` : ν•™μµ κ³΅μ„  μƒμ„±μ— ν•„μ”ν• ν›λ μƒν”κ³Ό κ°μ λΉ„μ¨μ„ μ΅°μ ν•©λ‹λ‹¤.

### κ²€μ¦κ³΅μ„ 
> ν•μ΄νΌ νλΌλ―Έν„°μ— λ”°λΌ κ³Όλ€, κ³Όμ† μ ν•© μ—¬λ¶€λ¥Ό νλ‹¨ν•λ” κ·Έλν”„
> > - X(ν•μ΄νΌ νλΌλ―Έν„° C),Y(μ •ν™•λ„)

```py
from matplotlib import pyplot as plt
from sklearn.model_selection import validation_curve

# κ²€μ¦ κ³΅μ„  λ§λ“¤κΈ°
train_scores, test_scores = validation_curve(estimator=λ¨λΈ, X=X_train, y=y_train, param_name='C', param_range=param_range, cv=10)

# κ²€μ¦ κ³΅μ„  κ·Έλ¦¬κΈ°
## ν•™μµ μ •ν™•λ„
plt.plot(param_range, train_mean, color='blue', marker='o', markersize=5, label='training accuracy')
plt.fill_between(param_range, train_mean + train_std, train_mean - train_std, alpha=0.15, color='blue')
## κ²€μ¦ μ •ν™•λ„
plt.plot(param_range, test_mean, color='green', linestyle='--', marker='s', markersize=5, label='validation accuracy')
plt.fill_between(param_range, test_mean + test_std, test_mean - test_std, alpha=0.15, color='green')

## κ·Έλ¦¬λ“ μ™Έ λΌλ²¨
plt.grid()
plt.xscale('log')
plt.legend(loc='lower right')
plt.xlabel('Param C') # ν•μ΄νΌ νλΌλ―Έν„° C
plt.ylabel('Accuracy')
plt.tight_layout()
plt.show()
```
- `param_range`μ—μ„λ” μ΄λ¦„μ²λΌ κ°’ λ²”μ„λ¥Ό μ§€μ •ν•΄μ¤λ‹λ‹¤.

> κ·μ  κ°•λ„λ¥Ό λ†’μ—¬ Cλ¥Ό μ¤„μ΄λ©΄ μ΅°κΈ κ³Όμ†μ ν•©λκ³ , κ·μ  κ°•λ„λ¥Ό λ‚®μ¶° Cλ¥Ό λλ¦¬λ©΄ μ΅°κΈ κ³Όλ€μ ν•©λ¨μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

[π”— μ‚¬μ΄ν‚·λ° ν•™μµ κ³΅μ„ , κ²€μ¦ κ³΅μ„ μΌλ΅ λ¨λΈμ κ³Όλ€μ ν•©, κ³Όμ†μ ν•© μ΅°μ‚¬ν•κΈ° - jellyho](https://jellyho.com/blog/85/)
[π”— `learning_curve` μ‚¬μ΄ν‚·λ° κ³µμ‹ λ„νλ¨ΌνΈ](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.learning_curve.html)
[π”— `validation_curve` μ‚¬μ΄ν‚·λ° κ³µμ‹ λ„νλ¨ΌνΈ](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.validation_curve.html#sklearn-model-selection-validation-curve)
### π’» `train_test_split(X_data, Y_data)`
- `test_size` : ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈμ λΉ„μ¨μ„ μλ―Έν•λ‹¤. 
- `random_state` : μν–‰μ‹ λ§λ‹¤ λ™μΌν• κ²°κ³Όλ¥Ό μ–»κΈ° μ„ν•΄ μ μ©ν•λ” μΈμ (λλ¤ κ°’ κ³ μ •)
- `shuffle` : λ°μ΄ν„°λ¥Ό λ‚λ„κΈ° μ „μ— μ„μ„μ§€μ— λ€ν• λ¶λ¦° μ—¬λ¶€
- `stratify` : λ¶„λ¥ λ¬Έμ μ—μ„ μ¤‘μ”ν•κ² λ‹¤λ£¨λ” νλΌλ―Έν„°λ΅ targetμ ν΄λμ¤ λΉ„μ¨μ„ μ μ§€ν•μ±„ λ‚λ μ μλ‹¤.

```py
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=22)

```

- λ°μ΄ν„°κ°€ λ§μ€ κ²½μ° : ν›λ ¨ / κ²€μ¦ / ν…μ¤νΈ λ°μ΄ν„° μ…‹μΌλ΅ λ‚λλ‹¤. (**Hold-Out κ²€μ¦**)
- λ°μ΄ν„°κ°€ μ μ€ κ²½μ° : **[K-fold κµμ°¨κ²€μ¦(k-fold cross validation)](https://github.com/dustin-kang/dataStudy/blob/main/ML/lesson/006_λ¨λΈ_μ„ νƒκ³Ό_λ¨λΈ_κ²€μ¦.md#k-κ²Ή-κµμ°¨κ²€μ¦k-fold-cross-validation)**μ„ μ§„ν–‰ν•λ‹¤.

- [π”— scikit-learn κ³µμ‹ λ„νλ¨ΌνΈ](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)
- [π”— How (and why) to create a good validation set
](https://www.fast.ai/posts/2017-11-13-validation-sets.html)
